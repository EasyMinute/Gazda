(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define("simpleParallax",[],factory);else if(typeof exports==="object")exports["simpleParallax"]=factory();else root["simpleParallax"]=factory()})(window,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(exports,"__esModule",{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if(mode&4&&typeof value==="object"&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,"default",{enumerable:true,value:value});if(mode&2&&typeof value!="string")for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Viewport=function(){function Viewport(){_classCallCheck(this,Viewport);this.positions={top:0,bottom:0,height:0}}_createClass(Viewport,[{key:"setViewportTop",value:function setViewportTop(container){this.positions.top=container?container.scrollTop:window.pageYOffset;return this.positions}},{key:"setViewportBottom",value:function setViewportBottom(){this.positions.bottom=this.positions.top+this.positions.height;return this.positions}},{key:"setViewportAll",value:function setViewportAll(container){this.positions.top=container?container.scrollTop:window.pageYOffset;this.positions.height=container?container.clientHeight:document.documentElement.clientHeight;this.positions.bottom=this.positions.top+this.positions.height;return this.positions}}]);return Viewport}();var viewport=new Viewport;var convertToArray=function convertToArray(elements){if(NodeList.prototype.isPrototypeOf(elements)||HTMLCollection.prototype.isPrototypeOf(elements))return Array.from(elements);if(typeof elements==="string"||elements instanceof String)return document.querySelectorAll(elements);return[elements]};var helpers_convertToArray=convertToArray;var cssTransform=function cssTransform(){var prefixes="transform webkitTransform mozTransform oTransform msTransform".split(" ");var transform;var i=0;while(transform===undefined){transform=document.createElement("div").style[prefixes[i]]!==undefined?prefixes[i]:undefined;i+=1}return transform};var helpers_cssTransform=cssTransform();var isImageLoaded=function isImageLoaded(image){if(!image){return false}if(!image.complete){return false}if(typeof image.naturalWidth!=="undefined"&&image.naturalWidth===0){return false}return true};var helpers_isImageLoaded=isImageLoaded;function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++){arr2[i]=arr[i]}return arr2}}function parallax_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function parallax_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function parallax_createClass(Constructor,protoProps,staticProps){if(protoProps)parallax_defineProperties(Constructor.prototype,protoProps);if(staticProps)parallax_defineProperties(Constructor,staticProps);return Constructor}var parallax_ParallaxInstance=function(){function ParallaxInstance(element,options){parallax_classCallCheck(this,ParallaxInstance);this.element=element;this.elementContainer=element;this.settings=options;this.isVisible=true;this.isInit=false;this.oldTranslateValue=-1;this.init=this.init.bind(this);if(helpers_isImageLoaded(element)){this.init()}else{this.element.addEventListener("load",this.init)}}parallax_createClass(ParallaxInstance,[{key:"init",value:function init(){var _this=this;if(this.isInit)return;if(this.element.closest(".simpleParallax"))return;if(this.settings.overflow===false){this.wrapElement(this.element)}this.setTransformCSS();this.getElementOffset();this.intersectionObserver();this.getTranslateValue();this.animate();if(this.settings.delay>0){setTimeout(function(){_this.setTransitionCSS()},10)}this.isInit=true}},{key:"wrapElement",value:function wrapElement(){var elementToWrap=this.element.closest("picture")||this.element;var wrapper=document.createElement("div");wrapper.classList.add("simpleParallax");wrapper.style.overflow="hidden";elementToWrap.parentNode.insertBefore(wrapper,elementToWrap);wrapper.appendChild(elementToWrap);this.elementContainer=wrapper}},{key:"unWrapElement",value:function unWrapElement(){var wrapper=this.elementContainer;wrapper.replaceWith.apply(wrapper,_toConsumableArray(wrapper.childNodes))}},{key:"setTransformCSS",value:function setTransformCSS(){if(this.settings.overflow===false){this.element.style[helpers_cssTransform]="scale(".concat(this.settings.scale,")")}this.element.style.willChange="transform"}},{key:"setTransitionCSS",value:function setTransitionCSS(){this.element.style.transition="transform ".concat(this.settings.delay,"s ").concat(this.settings.transition)}},{key:"unSetStyle",value:function unSetStyle(){this.element.style.willChange="";this.element.style[helpers_cssTransform]="";this.element.style.transition=""}},{key:"getElementOffset",value:function getElementOffset(){var parent_positions=this.elementContainer.parentElement.getBoundingClientRect();this.elementParentHeight=parent_positions.height;var positions=this.elementContainer.getBoundingClientRect();this.elementHeight=positions.height;this.elementTop=positions.top+viewport.positions.top;if(this.settings.customContainer){var parentPositions=this.settings.customContainer.getBoundingClientRect();this.elementTop=positions.top-parentPositions.top+viewport.positions.top}this.elementBottom=this.elementHeight+this.elementTop}},{key:"buildThresholdList",value:function buildThresholdList(){var thresholds=[];for(var i=1;i<=this.elementHeight;i++){var ratio=i/this.elementHeight;thresholds.push(ratio)}return thresholds}},{key:"intersectionObserver",value:function intersectionObserver(){var options={root:null,threshold:this.buildThresholdList()};this.observer=new IntersectionObserver(this.intersectionObserverCallback.bind(this),options);this.observer.observe(this.element)}},{key:"intersectionObserverCallback",value:function intersectionObserverCallback(entries){for(var i=entries.length-1;i>=0;i--){if(entries[i].isIntersecting){this.isVisible=true}else{this.isVisible=false}}}},{key:"checkIfVisible",value:function checkIfVisible(){return this.elementBottom>viewport.positions.top&&this.elementTop<viewport.positions.bottom}},{key:"getRangeMax",value:function getRangeMax(){var elementImageHeight=this.element.clientHeight;this.rangeMax=elementImageHeight*this.settings.scale-elementImageHeight}},{key:"getTranslateValue",value:function getTranslateValue(){var percentage=((viewport.positions.bottom-this.elementTop)/((viewport.positions.height+this.elementHeight)/100)).toFixed(1);percentage=Math.min(100,Math.max(0,percentage));if(this.oldPercentage===percentage){return false}if(!this.rangeMax){this.getRangeMax()}this.translateValue=percentage/100*this.rangeMax-this.rangeMax/2;var delta=(this.elementHeight-this.elementParentHeight)/2;if(delta>0&&delta+this.translateValue<0){this.translateValue=-delta}if(delta>0&&delta<this.translateValue){this.translateValue=delta}this.translateValue=this.translateValue.toFixed(0);if(this.oldTranslateValue===this.translateValue){return false}this.oldPercentage=percentage;this.oldTranslateValue=this.translateValue;return true}},{key:"animate",value:function animate(){var translateValueY=0;var translateValueX=0;var inlineCss;if(this.settings.orientation.includes("left")||this.settings.orientation.includes("right")){translateValueX="".concat(this.settings.orientation.includes("left")?this.translateValue*-1:this.translateValue,"px")}if(this.settings.orientation.includes("up")||this.settings.orientation.includes("down")){translateValueY="".concat(this.settings.orientation.includes("up")?this.translateValue*-1:this.translateValue,"px")}if(this.settings.overflow===false){inlineCss="translate3d(".concat(translateValueX,", ").concat(translateValueY,", 0) scale(").concat(this.settings.scale,")")}else{inlineCss="translate3d(".concat(translateValueX,", ").concat(translateValueY,", 0)")}this.element.style[helpers_cssTransform]=inlineCss}}]);return ParallaxInstance}();var parallax=parallax_ParallaxInstance;__webpack_require__.d(__webpack_exports__,"default",function(){return simpleParallax_SimpleParallax});function simpleParallax_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function simpleParallax_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function simpleParallax_createClass(Constructor,protoProps,staticProps){if(protoProps)simpleParallax_defineProperties(Constructor.prototype,protoProps);if(staticProps)simpleParallax_defineProperties(Constructor,staticProps);return Constructor}var intersectionObserverAvailable=true;var isInit=false;var instances=[];var instancesLength;var frameID;var resizeID;var simpleParallax_SimpleParallax=function(){function SimpleParallax(elements,options){simpleParallax_classCallCheck(this,SimpleParallax);if(!elements)return;this.elements=helpers_convertToArray(elements);this.defaults={delay:.4,orientation:"up",scale:1.3,overflow:false,transition:"cubic-bezier(0,0,0,1)",customContainer:false};this.settings=Object.assign(this.defaults,options);if(!("IntersectionObserver"in window))intersectionObserverAvailable=false;if(this.settings.customContainer){this.customContainer=helpers_convertToArray(this.settings.customContainer)[0]}this.lastPosition=-1;this.resizeIsDone=this.resizeIsDone.bind(this);this.handleResize=this.handleResize.bind(this);this.proceedRequestAnimationFrame=this.proceedRequestAnimationFrame.bind(this);this.init()}simpleParallax_createClass(SimpleParallax,[{key:"init",value:function init(){viewport.setViewportAll(this.customContainer);for(var i=this.elements.length-1;i>=0;i--){var instance=new parallax(this.elements[i],this.settings);instances.push(instance)}instancesLength=instances.length;if(!isInit){this.proceedRequestAnimationFrame();window.addEventListener("resize",this.resizeIsDone);isInit=true}}},{key:"resizeIsDone",value:function resizeIsDone(){clearTimeout(resizeID);resizeID=setTimeout(this.handleResize,500)}},{key:"handleResize",value:function handleResize(){viewport.setViewportAll(this.customContainer);for(var i=instancesLength-1;i>=0;i--){instances[i].getElementOffset();instances[i].getRangeMax()}this.lastPosition=-1}},{key:"proceedRequestAnimationFrame",value:function proceedRequestAnimationFrame(){viewport.setViewportTop(this.customContainer);if(this.lastPosition===viewport.positions.top){frameID=window.requestAnimationFrame(this.proceedRequestAnimationFrame);return}viewport.setViewportBottom();for(var i=instancesLength-1;i>=0;i--){this.proceedElement(instances[i])}frameID=window.requestAnimationFrame(this.proceedRequestAnimationFrame);this.lastPosition=viewport.positions.top}},{key:"proceedElement",value:function proceedElement(instance){var isVisible=false;if(!intersectionObserverAvailable||this.customContainer){isVisible=instance.checkIfVisible()}else{isVisible=instance.isVisible}if(!isVisible)return;if(!instance.getTranslateValue()){return}instance.animate()}},{key:"destroy",value:function destroy(){var _this=this;var instancesToDestroy=[];instances=instances.filter(function(instance){if(_this.elements.includes(instance.element)){instancesToDestroy.push(instance);return false}return instance});for(var i=instancesToDestroy.length-1;i>=0;i--){instancesToDestroy[i].unSetStyle();if(this.settings.overflow===false){instancesToDestroy[i].unWrapElement()}}instancesLength=instances.length;if(!instancesLength){window.cancelAnimationFrame(frameID);window.removeEventListener("resize",this.handleResize)}}}]);return SimpleParallax}()}])["default"]});